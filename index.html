<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super Jump</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Farcaster Mini App Metadata -->
    <meta name="fc:miniapp" content='{
        "version":"1",
        "imageUrl":"https://super-jump-opal.vercel.app/image.png",
        "button":{
            "title":"Play Super Jump & Earn!",
            "action":{
            "type":"launch_frame",
            "name":"Super Jump",
            "url":"https://super-jump-opal.vercel.app",
            "splashImageUrl":"https://super-jump-opal.vercel.app/splash.png",
            "splashBackgroundColor":"#00111a"
            }
        }
    }' />

    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <canvas id="gameCanvas"></canvas>

    <div class="ui-overlay" id="uiOverlay" style="display: none;">
        <div class="score-display">
            Score: <span id="scoreDisplay">0</span>
        </div>
    </div>

    <!-- Main Menu -->
    <div class="menu-overlay" id="mainMenu">
       <h1 style="font-size: 48px; margin-bottom: 10px; margin-top: 50px;">Super Jump</h1>
        
        <div class="wallet-container">
            <div class="wallet-status">
                <div class="wallet-indicator" id="walletIndicator"></div>
                <span id="walletStatus">Not Connected</span>
            </div>
            <div id="walletInfo" style="display: none;">
                <div id="walletAddress" style="font-family: monospace; margin: 10px 0;"></div>
            </div>
            <button class="btn" id="connectBtn" onclick="window.connectWallet()">Connect Wallet</button>
        </div>

        <div class="score-reward-info">
            <div style="font-size: 18px; font-weight: 700; margin-bottom: 10px;">ğŸ¯ Score & Earn!</div>
            <div>Score 30+ points to claim rewards</div>
            <div id="prizePoolStatus" style="margin-top: 10px; font-size: 14px; color: rgba(255, 255, 255, 0.8);">
                ğŸ’° Checking prize pool...
            </div>
        </div>

        <button class="btn" id="playBtn" onclick="window.startGameFromMenu()" disabled>Play Game</button>
    </div>

    <!-- Farcaster Profile Header -->
    <div id="profileHeader" class="profile-header" style="display: none;">
        <div id="profileAvatar" class="profile-avatar">?</div>
        <div class="profile-info">
            <div id="profileUsername" class="profile-username">Loading...</div>
        </div>
    </div>

    <!-- Leaderboard Button -->
    <button class="leaderboard-btn" id="leaderboardBtn" onclick="window.toggleLeaderboard()" style="display: none;">
         Leaderboard
    </button>

    <!-- Game Over Screen -->
    <div class="game-over-overlay" id="gameOverScreen">
        <div class="game-over-content">
            <h2 style="font-size: 32px; margin-bottom: 20px;">Game Over</h2>
            <div style="font-size: 48px; color: #4a90e2; margin-bottom: 20px;" id="finalScore">0</div>
            
            <div id="scoreRewardSection">
                <div id="eligibleReward" style="display: none;">
                    <div class="score-reward-info">
                        <div style="font-size: 18px; font-weight: 700; margin-bottom: 10px;">ğŸ‰ Congratulations!</div>
                        <div>You scored 30+ points! Submit to leaderboard and claim your ETH reward!</div>
                    </div>
                    
                    <button class="submit-score-btn" onclick="window.submitScoreOnChain()">
                        ğŸ“Š Submit to Leaderboard
                    </button>
                    
                    <button class="claim-btn" id="claimScoreBtn" onclick="window.claimScoreReward()">
                        ğŸ’° Claim ETH Reward
                    </button>
                </div>
                <div id="notEligibleReward" style="display: none;">
                    <div class="score-reward-info" style="background: rgba(239, 68, 68, 0.2); border-color: rgba(239, 68, 68, 0.5);">
                        <div style="font-size: 18px; font-weight: 700; color: #ef4444; margin-bottom: 10px;">ğŸ¯ Almost There!</div>
                        <div>Score 30+ points to submit to leaderboard and earn ETH!</div>
                    </div>
                </div>
            </div>

            <button class="share-btn" onclick="window.shareScore()">
                ğŸ¯ Share Score
            </button>

            <button class="btn" style="background: linear-gradient(135deg, #b78900, #CA8A04); width: 100%; margin: 10px 0; padding-left: 20px; padding-right: 20px;" onclick="window.showLeaderboard()">
                ğŸ† View Leaderboard
            </button>
            
            <button class="btn" onclick="window.backToMenu()">ğŸ’ª Play Again</button>
        </div>
    </div>

    <!-- Leaderboard Screen -->
    <div class="leaderboard-screen" id="leaderboardScreen">
        <div class="leaderboard-content">
            <h2 class="leaderboard-title">ğŸ† Top 50 Players</h2>
            
            <div class="leaderboard-list" id="leaderboardList">
                <div class="empty-leaderboard">
                    <p style="font-size: 18px; margin-bottom: 10px;">Loading leaderboard...</p>
                    <div class="loading-spinner"></div>
                </div>
            </div>
            
            <button class="btn" style="width: 100%; margin-top: 20px;" onclick="window.hideLeaderboard()">
                ğŸ  Back
            </button>
        </div>
    </div>

    <!-- Load main script as module -->
    <script type="module" src="./main.js"></script>
</body>
</html>